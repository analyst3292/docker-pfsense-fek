<source>
  @type syslog
  port 5514
  bind 0.0.0.0
  tag pfsense

  format grok
  grok_pattern %{PFSENSE_SYSLOG_PATTERN}
  custom_pattern_path /fluentd/etc/patterns
</source>

<filter pfsense.**>
  @type ignore
  regexp1 src_ip ^(224|232|239|fe80|ff02).*
</filter>
<filter pfsense.**>
  @type ignore
  regexp1 dest_ip ^(224|232|239|fe80|ff02).*
</filter>

<filter pfsense.**>
  @type geoip
  key_name src_ip
</filter>

<filter pfsense.**>
  type resolv
  key_name src_ip
  key_prefix fqdn
</filter>


<match pfsense.**>
  type copy

  <store>
    type elasticsearch
    host elasticsearch
    port 9200
    flush_interval 10
    logstash_prefix pfsense
    logstash_format true
    include_tag_key true
  </store>

  <store>
    type stdout
  </store>
</match>